<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1252px" preserveAspectRatio="none" style="width:810px;height:1252px;" version="1.1" viewBox="0 0 810 1252" width="810px" zoomAndPan="magnify"><defs><filter height="300%" id="fpb3b7g2nc37x" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="1238.6709" style="stroke: #000000; stroke-width: 1.0;" width="796" x="3" y="3"/><path d="M95,4 L95,15.0679 L85,25.0679 L3,25.0679 " fill="none" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="6" y="18.9659">normal boot</text><rect fill="#DDDDDD" height="1198.294" style="stroke: #A80036; stroke-width: 1.0;" width="645.5" x="84.5" y="33.0679"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="381.75" y="46.9649">Storage</text><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="78.5" y="257.0957"/><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="185" y="444.6258"/><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="321.5" y="604.1559"/><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="458.5" y="795.392"/><rect fill="#FFFFFF" filter="url(#fpb3b7g2nc37x)" height="85.118" style="stroke: #000000; stroke-width: 2.0;" width="323.5" x="458.5" y="1018.3341"/><rect fill="#FFFFFF" height="33.706" style="stroke: none; stroke-width: 1.0;" width="323.5" x="458.5" y="1069.7461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="130.5" x2="130.5" y1="130.9777" y2="1152.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="254" x2="254" y1="130.9777" y2="1152.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="376.5" x2="376.5" y1="130.9777" y2="1152.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="518.5" x2="518.5" y1="130.9777" y2="1152.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="668" x2="668" y1="130.9777" y2="1152.1582"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="754" x2="754" y1="130.9777" y2="1152.1582"/><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="88.5" y="92.9098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="95.5" y="114.8757">ROMCode</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="88.5" y="1151.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="95.5" y="1173.1241">ROMCode</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="195" y="92.9098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="202" y="114.8757">pre bootloader</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="195" y="1151.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="202" y="1173.1241">pre bootloader</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="331.5" y="92.9098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="338.5" y="114.8757">bootloader</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="331.5" y="1151.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="338.5" y="1173.1241">bootloader</text><rect fill="#FF0000" filter="url(#fpb3b7g2nc37x)" height="71.2038" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="468.5" y="54.7739"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="475.5" y="76.7399">Kernel+dtb+</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="486.5" y="95.8078">initramfs</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="475.5" y="114.8757">with cominit</text><rect fill="#FF0000" filter="url(#fpb3b7g2nc37x)" height="71.2038" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="468.5" y="1151.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="475.5" y="1173.1241">Kernel+dtb+</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="486.5" y="1192.192">initramfs</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="475.5" y="1211.2599">with cominit</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="610" y="92.9098"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="617" y="114.8757">rootfs with init</text><rect fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" height="33.0679" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="610" y="1151.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="617" y="1173.1241">rootfs with init</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="736.5" y="126.8757">TPM</text><path d="M736,75.9098 C736,65.9098 754,65.9098 754,65.9098 C754,65.9098 772,65.9098 772,75.9098 L772,101.9098 C772,111.9098 754,111.9098 754,111.9098 C754,111.9098 736,111.9098 736,101.9098 L736,75.9098 " fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M736,75.9098 C736,85.9098 754,85.9098 754,85.9098 C754,85.9098 772,85.9098 772,75.9098 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="736.5" y="1166.1241">TPM</text><path d="M736,1180.2261 C736,1170.2261 754,1170.2261 754,1170.2261 C754,1170.2261 772,1170.2261 772,1180.2261 L772,1206.2261 C772,1216.2261 754,1216.2261 754,1216.2261 C754,1216.2261 736,1216.2261 736,1206.2261 L736,1180.2261 " fill="#FEFECE" filter="url(#fpb3b7g2nc37x)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M736,1180.2261 C736,1190.2261 754,1190.2261 754,1190.2261 C754,1190.2261 772,1190.2261 772,1180.2261 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="784" x="8" y="162.8307"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="162.8307" y2="162.8307"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="165.8307" y2="165.8307"/><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="177" x="311.5" y="150.9777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="160" x="317.5" y="168.8747">SoC specific trusted boot</text><polygon fill="#A80036" points="119,206.3897,129,210.3897,119,214.3897,123,210.3897" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="8" x2="125" y1="210.3897" y2="210.3897"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="15" y="204.5807">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="26" y="204.5807">receive control</text><polygon fill="#A80036" points="242,238.0957,252,242.0957,242,246.0957,246,242.0957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="131" x2="248" y1="242.0957" y2="242.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="138" y="236.2867">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="149" y="236.2867">load and verify</text><path d="M78.5,257.0957 L141.5,257.0957 L141.5,266.0957 L131.5,276.0957 L78.5,276.0957 L78.5,257.0957 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="78.5" y="257.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="93.5" y="271.9927">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="156.5" y="270.8546">[on verification failure]</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="131" x2="173" y1="300.5078" y2="300.5078"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="173" x2="173" y1="300.5078" y2="313.5078"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="132" x2="173" y1="313.5078" y2="313.5078"/><polygon fill="#A80036" points="142,309.5078,132,313.5078,142,317.5078,138,313.5078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="138" y="294.6988">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="149" y="294.6988">stop</text><polygon fill="#A80036" points="242,348.2138,252,352.2138,242,356.2138,246,352.2138" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131" x2="248" y1="352.2138" y2="352.2138"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="138" y="346.4048">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="149" y="346.4048">pass control</text><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="784" x="8" y="382.0668"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="382.0668" y2="382.0668"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="385.0668" y2="385.0668"/><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="224" x="288" y="370.2138"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="294" y="388.1108">Generic trusted/measured boot</text><polygon fill="#A80036" points="365,425.6258,375,429.6258,365,433.6258,369,429.6258" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="254" x2="371" y1="429.6258" y2="429.6258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="261" y="423.8168">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="272" y="423.8168">load and verify</text><path d="M185,444.6258 L248,444.6258 L248,453.6258 L238,463.6258 L185,463.6258 L185,444.6258 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="185" y="444.6258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="200" y="459.5228">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="263" y="458.3847">[on verification failure]</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="254" x2="296" y1="488.0378" y2="488.0378"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="296" x2="296" y1="488.0378" y2="501.0378"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="255" x2="296" y1="501.0378" y2="501.0378"/><polygon fill="#A80036" points="265,497.0378,255,501.0378,265,505.0378,261,501.0378" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="261" y="482.2288">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="272" y="482.2288">stop</text><polygon fill="#A80036" points="365,535.7439,375,539.7439,365,543.7439,369,539.7439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="254" x2="371" y1="539.7439" y2="539.7439"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="261" y="533.9349">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="272" y="533.9349">pass control</text><polygon fill="#A80036" points="507,585.1559,517,589.1559,507,593.1559,511,589.1559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="377" x2="513" y1="589.1559" y2="589.1559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="384" y="574.4939">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="395" y="565.6409">load and verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="395" y="583.3469">against public key</text><path d="M321.5,604.1559 L384.5,604.1559 L384.5,613.1559 L374.5,623.1559 L321.5,623.1559 L321.5,604.1559 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="321.5" y="604.1559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="336.5" y="619.0529">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="399.5" y="617.9148">[on verification failure]</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="377" x2="419" y1="647.5679" y2="647.5679"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="419" x2="419" y1="647.5679" y2="660.5679"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="378" x2="419" y1="660.5679" y2="660.5679"/><polygon fill="#A80036" points="388,656.5679,378,660.5679,388,664.5679,384,660.5679" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="384" y="641.7589">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="395" y="641.7589">stop</text><polygon fill="#A80036" points="742,695.2739,752,699.2739,742,703.2739,746,699.2739" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="377" x2="748" y1="699.2739" y2="699.2739"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="384" y="693.4649">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="402" y="693.4649">extend public key to PCRn</text><polygon fill="#A80036" points="507,726.98,517,730.98,507,734.98,511,730.98" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="377" x2="513" y1="730.98" y2="730.98"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="384" y="725.171">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="402" y="725.171">pass control</text><polygon fill="#A80036" points="656,776.392,666,780.392,656,784.392,660,780.392" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="519" x2="662" y1="780.392" y2="780.392"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="526" y="765.73">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="544" y="756.877">init and verify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="544" y="774.583">against public key</text><path d="M458.5,795.392 L521.5,795.392 L521.5,804.392 L511.5,814.392 L458.5,814.392 L458.5,795.392 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="64.412" style="stroke: #000000; stroke-width: 2.0;" width="210" x="458.5" y="795.392"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="473.5" y="810.289">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="536.5" y="809.1509">[on verification failure]</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="519" x2="561" y1="838.804" y2="838.804"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="561" x2="561" y1="838.804" y2="851.804"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="520" x2="561" y1="851.804" y2="851.804"/><polygon fill="#A80036" points="530,847.804,520,851.804,530,855.804,526,851.804" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="526" y="832.995">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="544" y="832.995">stop</text><polygon fill="#A80036" points="742,886.51,752,890.51,742,894.51,746,890.51" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="890.51" y2="890.51"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="526" y="884.701">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="544" y="884.701">extend public key to PCRm</text><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="784" x="8" y="920.3631"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="920.3631" y2="920.3631"/><line style="stroke: #000000; stroke-width: 1.0;" x1="8" x2="792" y1="923.3631" y2="923.3631"/><rect fill="#EEEEEE" filter="url(#fpb3b7g2nc37x)" height="25.706" style="stroke: #000000; stroke-width: 2.0;" width="83" x="358.5" y="908.51"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="364.5" y="926.4071">Unsealing</text><polygon fill="#A80036" points="742,999.3341,752,1003.3341,742,1007.3341,746,1003.3341" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="748" y1="1003.3341" y2="1003.3341"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="526" y="979.8191">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="544" y="962.1131">request to unseal</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="544" y="979.8191">secrets</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="544" y="997.5251">using PCRn+m</text><path d="M458.5,1018.3341 L521.5,1018.3341 L521.5,1027.3341 L511.5,1037.3341 L458.5,1037.3341 L458.5,1018.3341 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.118" style="stroke: #000000; stroke-width: 2.0;" width="323.5" x="458.5" y="1018.3341"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="473.5" y="1033.2311">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="536.5" y="1032.093">[unseal successful]</text><polygon fill="#A80036" points="530,1057.7461,520,1061.7461,530,1065.7461,526,1061.7461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="753" y1="1061.7461" y2="1061.7461"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="536" y="1055.9371">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="554" y="1055.9371">decrypted secrets</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="458.5" x2="782" y1="1070.7461" y2="1070.7461"/><polygon fill="#A80036" points="530,1091.4522,520,1095.4522,530,1099.4522,526,1095.4522" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="753" y1="1095.4522" y2="1095.4522"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="536" y="1089.6432">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="554" y="1089.6432">error message</text><polygon fill="#A80036" points="656,1130.1582,666,1134.1582,656,1138.1582,660,1134.1582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="519" x2="662" y1="1134.1582" y2="1134.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="14" x="526" y="1128.3492">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="544" y="1128.3492">pass control</text><!--MD5=[26076a53b62b669302d4e7f6379746d4]
@startuml secure_boot_highlevel_flow

autonumber

box "Storage"
  participant "ROMCode" as rom
  participant "pre bootloader" as spl
  participant "bootloader" as bldr
  participant "Kernel+dtb+\ninitramfs\nwith cominit" as fit #red
  participant "rootfs with init" as rootfs
end box

database "TPM" as tpm


mainframe normal boot

== SoC specific trusted boot ==

-> rom : receive control

rom - -> spl : load and verify
alt on verification failure
  rom - -> rom : stop
end
rom -> spl : pass control

== Generic trusted/measured boot ==

spl - -> bldr : load and verify
alt on verification failure
  spl - -> spl : stop
end
spl -> bldr : pass control


bldr - -> fit : load and verify\nagainst public key
alt on verification failure
  bldr - -> bldr : stop
end
bldr -> tpm : extend public key to PCRn
bldr -> fit : pass control


fit - -> rootfs : init and verify\nagainst public key
alt on verification failure
  fit - -> fit : stop
end
fit -> tpm : extend public key to PCRm

== Unsealing ==


fit -> tpm : request to unseal\nsecrets\nusing PCRn+m
alt unseal successful
  tpm -> fit : decrypted secrets
else
  tpm -> fit : error message
end


fit -> rootfs : pass control


@enduml

PlantUML version 1.2020.02(Sun Mar 01 11:22:07 CET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.7+6-Ubuntu-0ubuntu124.04
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>